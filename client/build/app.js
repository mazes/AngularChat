"use strict";var socket=io.connect("http://localhost:8080");angular.module("angularChat",["ui.bootstrap","ngRoute"]),angular.module("angularChat").config(["$routeProvider",function(o){o.when("/login",{templateUrl:"login/login.html",controller:"LoginController"}).when("/roomlist",{templateUrl:"roomlist/roomlist.html",controller:"RoomListController"}).when("/createroom",{templateUrl:"createroom/createroom.html",controller:"CreateRoomController"}).when("/chat",{templateUrl:"chat/chat.html",controller:"ChatController"})}]);var uglify=require("gulp-uglifyjs"),jshint=require("gulp-jshint"),gulp=require("gulp"),connect=require("gulp-connect"),clean=require("gulp-clean");gulp.task("default",["webserver"]),gulp.task("jshint",function(){return gulp.src(["**/*.js","!node_modules/**/*"]).pipe(jshint()).pipe(jshint(".jshintrc")).pipe(jshint.reporter("default"))}),gulp.task("uglify",function(){return gulp.src(["*.js","**/*.js","!node_modules/**/*"]).pipe(uglify()).pipe(gulp.dest("../build"))}),gulp.task("webserver",function(){connect.server({port:8008})}),gulp.task("clean",function(){gulp.src("../build/*.js",{read:!1}).pipe(clean())}),angular.module("angularChat").controller("ChatController",["$scope","$http","$location","ChatResource",function(o){o.chat=[{user:"Jaun",timestamp:"21:31:06",message:"hi"},{user:"alexa",timestamp:"21:32:07",message:"hello"},{user:"Jaun",timestamp:"21:33:02",message:"how you doin?"},{user:"Jaun",timestamp:"21:35:20",message:"like a glove"}],o.currentChatroom="Funderland"}]),angular.module("angularChat").controller("CreateRoomController",["$scope","$http","$location","ChatResource",function(o,e,t,r){o.createRoom=function(){o.room={room:void 0,pass:void 0,topic:o.topic},r.joinRoom(o.room,function(o,e){o||console.log(e)})}}]),angular.module("angularChat").controller("LoginController",["$scope","$http","$location","ChatResource",function(o,e,t,r){o.user="",o.pass="xxx",o.errorMessage="muu";o.onLogin=function(){r.login(o.user,o.pass,function(e){e?(t.url("/roomlist"),o.$apply()):(o.errorMessage="Login failed!",o.$apply())})}}]),angular.module("angularChat").factory("ChatResource",function(){return{login:function(o,e,t){socket.emit("adduser",o,t)},getRoomList:function(){socket.emit("rooms")},getUsers:function(){socket.emit("users")},joinRoom:function(o,e){console.log(o),socket.emit("joinroom",o,e)}}}),angular.module("angularChat").controller("RoomListController",["$scope","$http","$location","ChatResource",function(o,e,t,r){o.users=[],o.rooms=[],o.userList=function(){r.getUsers(),socket.on("userlist",function(e){o.users=e,o.$apply()})},o.getRooms=function(){r.getRoomList(),socket.on("roomlist",function(e){o.rooms=e,o.$apply()})}}]);